{% extends 'trip/base.html' %}
{% load static %}
{% block title %} Friends {% endblock title %}
{% block body %}
<div class="min-h-screen pt-20 pb-12">
  <div class="max-w-7xl mx-auto px-4">
    <div class="flex justify-between items-center mb-8">
      <div>
        <h1 class="text-4xl font-bold gradient-text mb-2">Friends</h1>
        <p class="text-gray-400">People who share groups with you</p>
        {% if overall_balance is not None %}
        <div class="mt-3 inline-flex items-center space-x-3 glass px-4 py-2 rounded-lg">
          <i class="fas fa-scale-balanced text-cyan-400"></i>
          {% if overall_balance == 0 %}
            <span class="text-white font-semibold">Balanced overall</span>
          {% elif overall_is_debtor %}
            <span class="text-gray-300">Overall:</span>
            <span class="text-red-400 font-bold">You owe ₹{{ overall_balance|floatformat:2|cut:"-" }}</span>
          {% else %}
            <span class="text-gray-300">Overall:</span>
            <span class="text-green-400 font-bold">You are owed ₹{{ overall_balance|floatformat:2 }}</span>
          {% endif %}
        </div>
        {% endif %}
      </div>
    </div>

    {% if friends %}
    <div class="bg-slate-800 rounded-xl shadow-xl overflow-hidden border border-slate-700">
      <div class="divide-y divide-slate-700">
        {% for f in friends %}
        <a href="{% url 'friend_detail' friend_uid=f.uid %}" class="block hover:bg-white/5 transition-colors">
          <div class="p-4 flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <div class="w-10 h-10 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-full flex items-center justify-center">
                {% if f.icon %}
                  <img src="{{ f.icon }}" alt="{{ f.username }}" class="w-full h-full rounded-full object-cover">
                {% else %}
                  <i class="fas fa-user text-white"></i>
                {% endif %}
              </div>
              <div>
                <p class="text-white font-semibold">{{ f.name }}</p>
                <p class="text-gray-400 text-sm">@{{ f.username }} • {{ f.groups_count }} groups</p>
              </div>
            </div>
            <div class="text-right">
              {% if f.balance == 0 %}
                <span class="text-gray-300 font-semibold">Settled</span>
              {% elif f.is_debtor %}
                <span class="text-red-400 font-semibold">You owe ₹{{ f.balance|floatformat:2|cut:"-" }}</span>
              {% else %}
                <span class="text-green-400 font-semibold">You are owed ₹{{ f.balance|floatformat:2 }}</span>
              {% endif %}
            </div>
          </div>
        </a>
        {% endfor %}
      </div>
    </div>
    {% else %}
      <div class="glass rounded-2xl p-12 text-center">
        <h2 class="text-3xl font-bold text-white mb-4">No Friends Yet</h2>
        <p class="text-gray-400">Invite people to your groups to see them here.</p>
      </div>
    {% endif %}
  </div>
</div>
{% endblock body %}
