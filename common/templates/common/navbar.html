{% load static %}
<nav class="fixed top-0 w-full z-50 glass-dark">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-20">
            <!-- Logo -->
            <div class="flex items-center space-x-2">
                <a href="{% url 'home' %}" class="flex items-center space-x-2 group">
                    <div class="w-10 h-10 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-lg flex items-center justify-center transform group-hover:scale-110 transition-transform">
                        <i class="fas fa-map text-white text-lg"></i>
                    </div>
                    <span class="text-xl font-bold gradient-text hidden sm:inline">TripVault</span>
                </a>
            </div>

            <!-- Desktop Menu -->
            <div class="hidden md:flex items-center space-x-8">
                <a href="{% url 'home' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </a>
                <a href="{% url 'plan-dashboard' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1">
                    <i class="fas fa-route"></i>
                    <span>Plan</span>
                </a>
                
                {% if request.user.is_authenticated %}
                <a href="{% url 'group' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1">
                    <i class="fas fa-users"></i>
                    <span>Groups</span>
                </a>
                <a href="{% url 'friends' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1">
                    <i class="fas fa-user-friends"></i>
                    <span>Friends</span>
                </a>
                <a href="{% url 'notifications' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1 relative">
                    <i class="fas fa-bell"></i>
                    <span>Activities</span>
                    {% if request.user.user %}
                        {% load custom_filters %}
                        {% with count=request.user.user|get_unread_activity_count %}
                            {% if count > 0 %}
                                <span class="absolute -top-2 -right-2 min-w-[1.25rem] h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center px-1 shadow-lg animate-pulse">
                                    {{ count }}
                                </span>
                            {% endif %}
                        {% endwith %}
                    {% endif %}
                </a>
                <a href="{% url 'userprofile' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1">
                    <i class="fas fa-user-circle"></i>
                    <span>Profile</span>
                </a>
                {% endif %}
                
                <a href="{% url 'support' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1">
                    <i class="fas fa-headset"></i>
                    <span>Support</span>
                </a>
            </div>

            <!-- Right side - User Menu or Auth Links -->
            <div class="flex items-center space-x-4">
                {% if request.user.is_authenticated %}
                <!-- User Dropdown -->
                <div class="relative group">
                    <button class="flex items-center space-x-3 px-5 py-2.5 rounded-xl bg-gradient-to-r from-cyan-500/20 to-blue-500/20 border border-cyan-400/30 hover:border-cyan-400/50 hover:from-cyan-500/30 hover:to-blue-500/30 transition-all duration-300">
                        <i class="fas fa-user text-cyan-400 text-lg"></i>
                        <span class="text-white font-semibold hidden sm:inline">{{ request.user.username }}</span>
                        <i class="fas fa-chevron-down text-cyan-400 text-xs group-hover:rotate-180 transition-transform duration-300"></i>
                    </button>
                    
                    <!-- Dropdown Menu -->
                    <div class="absolute right-0 mt-3 w-56 bg-gradient-to-br from-slate-800/95 to-slate-900/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-cyan-400/20 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 py-3 overflow-hidden">
                        
                        <a href="{% url 'userprofile' %}" class="flex items-center space-x-3 px-5 py-3 text-gray-300 hover:text-white hover:bg-cyan-500/10 transition-all duration-200 group/item">
                            <i class="fas fa-user-circle text-cyan-400 text-lg w-5"></i> 
                            <span class="font-medium">Profile</span>
                            <i class="fas fa-arrow-right ml-auto text-cyan-400 opacity-0 group-hover/item:opacity-100 transition-opacity"></i>
                        </a>
                        <a href="{% url 'group' %}" class="flex items-center space-x-3 px-5 py-3 text-gray-300 hover:text-white hover:bg-cyan-500/10 transition-all duration-200 group/item">
                            <i class="fas fa-users text-cyan-400 text-lg w-5"></i> 
                            <span class="font-medium">Groups</span>
                            <i class="fas fa-arrow-right ml-auto text-cyan-400 opacity-0 group-hover/item:opacity-100 transition-opacity"></i>
                        </a>
                        <a href="{% url 'saved-trips' %}" class="flex items-center space-x-3 px-5 py-3 text-gray-300 hover:text-white hover:bg-cyan-500/10 transition-all duration-200 group/item">
                            <i class="fas fa-save text-cyan-400 text-lg w-5"></i> 
                            <span class="font-medium">My Trips</span>
                            <i class="fas fa-arrow-right ml-auto text-cyan-400 opacity-0 group-hover/item:opacity-100 transition-opacity"></i>
                        </a>
                        <div class="my-2 mx-3 border-t border-cyan-400/20"></div>
                        <form method="post" action="{% url 'logout' %}" class="px-5 py-2">
                            {% csrf_token %}
                            <button type="submit" class="flex items-center space-x-3 w-full text-left py-3 px-0 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-all duration-200 font-medium group/item">
                                <i class="fas fa-sign-out-alt text-lg w-5"></i> 
                                <span>Logout</span>
                                <i class="fas fa-arrow-right ml-auto opacity-0 group-hover/item:opacity-100 transition-opacity"></i>
                            </button>
                        </form>
                    </div>
                </div>
                {% else %}
                <!-- Auth Links -->
                <a href="{% url 'login' %}" class="px-4 py-2 text-gray-300 hover:text-cyan-400 transition-colors">
                    <i class="fas fa-sign-in-alt mr-1"></i> Login
                </a>
                <a href="{% url 'customerregistration' %}" class="px-4 py-2 rounded-lg btn-gradient text-white font-semibold hover:shadow-lg">
                    <i class="fas fa-user-plus mr-1"></i> Register
                </a>
                {% endif %}
            </div>

            <!-- Mobile menu button -->
            <button id="mobile-menu-btn" class="md:hidden text-gray-300 hover:text-cyan-400 transition-colors">
                <i class="fas fa-bars text-2xl"></i>
            </button>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden pb-4">
            <a href="{% url 'home' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Home</a>
            <a href="{% url 'plan-dashboard' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Plan</a>
            {% if request.user.is_authenticated %}
            <a href="{% url 'group' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Groups</a>
            <a href="{% url 'friends' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Friends</a>
            <a href="{% url 'notifications' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded flex items-center justify-between">
                <span>Activities</span>
                {% if request.user.user %}
                    {% load custom_filters %}
                    {% with count=request.user.user|get_unread_activity_count %}
                        {% if count > 0 %}
                            <span class="px-2 py-1 bg-red-500 text-white text-xs font-bold rounded-full">{{ count }}</span>
                        {% endif %}
                    {% endwith %}
                {% endif %}
            </a>
            <a href="{% url 'userprofile' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Profile</a>
            <a href="{% url 'support' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Support</a>
            <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit" class="w-full text-left px-4 py-2 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded">Logout</button>
            </form>
            {% else %}
            <a href="{% url 'login' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Login</a>
            <a href="{% url 'customerregistration' %}" class="block px-4 py-2 text-cyan-400 hover:text-cyan-300">Register</a>
            {% endif %}
        </div>
    </div>
</nav>

<script>
    document.getElementById('mobile-menu-btn')?.addEventListener('click', () => {
        const menu = document.getElementById('mobile-menu');
        menu.classList.toggle('hidden');
    });
</script>
  }

  // Attach event listeners after DOMContentLoaded
  document.querySelector('.navbar-brand').addEventListener('mouseover', showDiv);
  document.querySelector('.navbar-brand').addEventListener('mouseout', hideDiv);

</script>