{% load static %}
<nav class="fixed top-0 w-full z-50 glass-dark">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-20">
            <!-- Logo -->
            <div class="flex items-center space-x-2">
                <a href="{% url 'home' %}" class="flex items-center space-x-2 group">
                    <div class="w-10 h-10 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-lg flex items-center justify-center transform group-hover:scale-110 transition-transform">
                        <i class="fas fa-map text-white text-lg"></i>
                    </div>
                    <span class="text-xl font-bold gradient-text hidden sm:inline">TripVault</span>
                </a>
            </div>

            <!-- Desktop Menu -->
            <div class="hidden md:flex items-center space-x-8">
                <a href="{% url 'home' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </a>
                
                {% if request.user.is_authenticated %}
                <a href="{% url 'group' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1">
                    <i class="fas fa-users"></i>
                    <span>Groups</span>
                </a>
                <a href="{% url 'friends' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1">
                    <i class="fas fa-user-friends"></i>
                    <span>Friends</span>
                </a>
                <a href="{% url 'notifications' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1 relative">
                    <i class="fas fa-bell"></i>
                    <span>Activities</span>
                    {% if request.user.user %}
                        {% load custom_filters %}
                        {% with count=request.user.user|get_unread_activity_count %}
                            {% if count > 0 %}
                                <span class="absolute -top-2 -right-2 min-w-[1.25rem] h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center px-1 shadow-lg animate-pulse">
                                    {{ count }}
                                </span>
                            {% endif %}
                        {% endwith %}
                    {% endif %}
                </a>
                <a href="{% url 'userprofile' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1">
                    <i class="fas fa-user-circle"></i>
                    <span>Profile</span>
                </a>
                {% endif %}
                
                <a href="{% url 'support' %}" class="text-gray-300 hover:text-cyan-400 transition-colors duration-300 flex items-center space-x-1">
                    <i class="fas fa-headset"></i>
                    <span>Support</span>
                </a>
            </div>

            <!-- Right side - User Menu or Auth Links -->
            <div class="flex items-center space-x-4">
                {% if request.user.is_authenticated %}
                <!-- User Dropdown -->
                <div class="relative group">
                    <button class="flex items-center space-x-2 px-4 py-2 rounded-lg glass hover:bg-opacity-80 transition-all">
                        <i class="fas fa-user text-cyan-400"></i>
                        <span class="text-gray-300 hidden sm:inline">{{ request.user.username }}</span>
                        <i class="fas fa-chevron-down text-gray-400 text-sm"></i>
                    </button>
                    
                    <!-- Dropdown Menu -->
                    <div class="absolute right-0 mt-2 w-48 glass rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 py-2">
                        <a href="{% url 'userprofile' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 transition-colors">
                            <i class="fas fa-user-circle mr-2"></i> Profile
                        </a>
                        <a href="{% url 'group' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 transition-colors">
                            <i class="fas fa-users mr-2"></i> Groups
                        </a>
                        <hr class="border-gray-700 my-2">
                        <form method="post" action="{% url 'logout' %}" class="px-4 py-2">
                            {% csrf_token %}
                            <button type="submit" class="w-full text-left text-red-400 hover:text-red-300 hover:bg-red-500/10 px-0 py-2 rounded transition-colors">
                                <i class="fas fa-sign-out-alt mr-2"></i> Logout
                            </button>
                        </form>
                    </div>
                </div>
                {% else %}
                <!-- Auth Links -->
                <a href="{% url 'login' %}" class="px-4 py-2 text-gray-300 hover:text-cyan-400 transition-colors">
                    <i class="fas fa-sign-in-alt mr-1"></i> Login
                </a>
                <a href="{% url 'customerregistration' %}" class="px-4 py-2 rounded-lg btn-gradient text-white font-semibold hover:shadow-lg">
                    <i class="fas fa-user-plus mr-1"></i> Register
                </a>
                {% endif %}
            </div>

            <!-- Mobile menu button -->
            <button id="mobile-menu-btn" class="md:hidden text-gray-300 hover:text-cyan-400 transition-colors">
                <i class="fas fa-bars text-2xl"></i>
            </button>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden pb-4">
            <a href="{% url 'home' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Home</a>
            {% if request.user.is_authenticated %}
            <a href="{% url 'group' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Groups</a>
            <a href="{% url 'friends' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Friends</a>
            <a href="{% url 'notifications' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded flex items-center justify-between">
                <span>Activities</span>
                {% if request.user.user %}
                    {% load custom_filters %}
                    {% with count=request.user.user|get_unread_activity_count %}
                        {% if count > 0 %}
                            <span class="px-2 py-1 bg-red-500 text-white text-xs font-bold rounded-full">{{ count }}</span>
                        {% endif %}
                    {% endwith %}
                {% endif %}
            </a>
            <a href="{% url 'userprofile' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Profile</a>
            <a href="{% url 'support' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Support</a>
            <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit" class="w-full text-left px-4 py-2 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded">Logout</button>
            </form>
            {% else %}
            <a href="{% url 'login' %}" class="block px-4 py-2 text-gray-300 hover:text-cyan-400 hover:bg-white/5 rounded">Login</a>
            <a href="{% url 'customerregistration' %}" class="block px-4 py-2 text-cyan-400 hover:text-cyan-300">Register</a>
            {% endif %}
        </div>
    </div>
</nav>

<script>
    document.getElementById('mobile-menu-btn')?.addEventListener('click', () => {
        const menu = document.getElementById('mobile-menu');
        menu.classList.toggle('hidden');
    });
</script>
  }

  // Attach event listeners after DOMContentLoaded
  document.querySelector('.navbar-brand').addEventListener('mouseover', showDiv);
  document.querySelector('.navbar-brand').addEventListener('mouseout', hideDiv);

</script>