</body>

<!-- Settings Sidebar (mobile only) -->
<!-- Overlay for closing sidebar -->
<div id="settings-sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-40 z-[100] hidden md:hidden"></div>
<div id="settings-sidebar" class="fixed top-0 right-0 h-full w-72 bg-gradient-to-b from-[#1e293b] to-[#0f172a] shadow-2xl z-[110] transition-transform duration-300 md:hidden" style="border-top-left-radius: 1.5rem; border-bottom-left-radius: 1.5rem; transform: translateX(100%);">
    <div class="flex flex-col h-full p-6 relative" tabindex="-1">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-lg font-bold text-cyan-300">Settings</h2>
            <button id="close-settings" class="text-white hover:text-cyan-400 text-3xl focus:outline-none z-50" style="background: none;"><i class="fas fa-times"></i></button>
        </div>
        <nav class="flex flex-col gap-3 mt-2">
            <a href="{% url 'home' %}" class="flex items-center gap-3 text-gray-300 hover:text-cyan-400 text-lg font-semibold sidebar-link">
                <i class="fas fa-home text-xl"></i>
                <span>Home</span>
            </a>
            <a href="{% url 'saved-trips' %}" class="flex items-center gap-3 text-gray-300 hover:text-cyan-400 text-lg font-semibold sidebar-link">
                <i class="fas fa-map-marked-alt text-xl"></i>
                <span>My Trips</span>
            </a>
            <a href="{% url 'plan-dashboard' %}" class="flex items-center gap-3 text-gray-300 hover:text-cyan-400 text-lg font-semibold sidebar-link">
                <i class="fas fa-route text-xl"></i>
                <span>Plan</span>
            </a>
            <a href="{% url 'userprofile' %}" class="flex items-center gap-3 text-gray-300 hover:text-cyan-400 text-lg font-semibold sidebar-link">
                <i class="fas fa-user-circle text-xl"></i>
                <span>Profile</span>
            </a>
            <a href="{% url 'support' %}" class="flex items-center gap-3 text-gray-300 hover:text-cyan-400 text-lg font-semibold sidebar-link">
                <i class="fas fa-headset text-xl"></i>
                <span>Support</span>
            </a>
            <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit" class="w-full flex items-center gap-3 text-red-400 hover:text-red-300 text-lg font-semibold sidebar-link">
                    <i class="fas fa-sign-out-alt text-xl"></i>
                    <span>Logout</span>
                </button>
            </form>
        </nav>
        <!-- Faded big icon at center bottom -->
        <div class="absolute left-1/2 bottom-6 -translate-x-1/2 pointer-events-none select-none opacity-10" style="font-size: 8rem;">
            <i class="fas fa-cog"></i>
        </div>
    </div>
</div>
<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
        <style>
            /* Hide scrollbars globally (all browsers) */
            html, body, * {
                scrollbar-width: none !important; /* Firefox */
                -ms-overflow-style: none !important; /* IE and Edge */
            }
            html::-webkit-scrollbar, body::-webkit-scrollbar, *::-webkit-scrollbar {
                display: none !important; /* Chrome, Safari, Opera */
            }
        </style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TripVault | {% block title %} {% endblock title %} </title>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="/tripvault/manifest.json">
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="TripVault">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'staticfiles/icons/icon-180.png' %}">
    <link rel="apple-touch-icon" sizes="192x192" href="{% static 'staticfiles/icons/icon-192.png' %}">
    <link rel="apple-touch-icon" sizes="512x512" href="{% static 'staticfiles/icons/icon-512.png' %}">
    <!-- Optional: Add more sizes for full iOS support -->
    <!-- <link rel="apple-touch-icon" sizes="152x152" href="{% static 'icons/icon-152.png' %}"> -->
    <!-- <link rel="apple-touch-icon" sizes="120x120" href="{% static 'icons/icon-120.png' %}"> -->
    <!-- <link rel="apple-touch-icon" sizes="76x76" href="{% static 'icons/icon-76.png' %}"> -->
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Hide scrollbars globally */
        html, body, * {
            scrollbar-width: none !important; /* Firefox */
            -ms-overflow-style: none !important; /* IE and Edge */
        }
        html::-webkit-scrollbar, body::-webkit-scrollbar, *::-webkit-scrollbar {
            display: none !important; /* Chrome, Safari, Opera */
        }
                /* iOS PWA yellow border fix */
                html, body, nav, .glass-dark, .glass {
                    border: none !important;
                    outline: none !important;
                    box-shadow: none !important;
                }
                /* Remove iOS PWA focus ring */
                *:focus {
                    outline: none !important;
                    box-shadow: none !important;
                }
                /* Remove iOS yellow border on tap */
                *:active {
                    outline: none !important;
                    box-shadow: none !important;
                }
                /* Remove iOS Safari focus ring */
                *::-webkit-focus-ring {
                    outline: none !important;
                }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* Glass morphism effect */
        .glass {
            background: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .glass-dark {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .btn-gradient {
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
            transition: all 0.3s ease;
        }
        
        .btn-gradient:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(6, 182, 212, 0.3);
        }
        
        /* Smooth transitions */
        a, button {
            transition: all 0.3s ease;
        }

        /* Remove all yellow borders and outlines globally */
        * {
            border-color: initial !important;
            outline-color: initial !important;
        }
        *[style*="border: 1px solid yellow"], *[style*="outline: 1px solid yellow"] {
            border: none !important;
            outline: none !important;
        }
        * {
            box-shadow: none !important;
        }
    </style>
    {% block style %} {% endblock style %}
</head>
        <style>
            .loader-zoom {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                animation: loader-zoom-in 1.2s cubic-bezier(0.4,0,0.2,1) infinite alternate;
            }
            .loader-circle {
                width: 64px;
                height: 64px;
                border-radius: 50%;
                border: 6px solid #06b6d4;
                border-top: 6px solid #3b82f6;
                border-bottom: 6px solid #0ea5e9;
                background: rgba(30,41,59,0.25);
                box-shadow: 0 0 32px 0 rgba(6,182,212,0.15);
                animation: loader-spin 1.1s linear infinite;
            }
            @keyframes loader-spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
            @keyframes loader-zoom-in {
                0% { transform: scale(1); }
                100% { transform: scale(1.15); }
            }
        </style>

<body>
            <!-- Loader Overlay -->
            <div id="global-loader" style="z-index:9999; position:fixed; top:0; left:0; width:100vw; height:100vh; background:linear-gradient(135deg,#0f172a 0%,#1e293b 50%,#0f172a 100%); display:flex; align-items:center; justify-content:center; transition:opacity 0.5s;">
                    <div class="loader-zoom">
                        <div class="loader-circle" style="display:flex; align-items:center; justify-content:center;">
                            <span class="loader-icon">
                                <svg width="38" height="38" viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <defs>
                                        <linearGradient id="icon-gradient" x1="0" y1="0" x2="38" y2="38" gradientUnits="userSpaceOnUse">
                                            <stop stop-color="#06b6d4"/>
                                            <stop offset="1" stop-color="#3b82f6"/>
                                        </linearGradient>
                                    </defs>
                                    <circle cx="19" cy="19" r="16" stroke="url(#icon-gradient)" stroke-width="3" fill="none"/>
                                    <path d="M19 10L24 19H14L19 10Z" fill="url(#icon-gradient)"/>
                                    <circle cx="19" cy="25" r="2.5" fill="url(#icon-gradient)"/>
                                </svg>
                            </span>
                        </div>
                    </div>
            </div>
            <script>
                // Hide loader after page load
                window.addEventListener('load', function() {
                    setTimeout(function() {
                        var loader = document.getElementById('global-loader');
                        if(loader) {
                            loader.style.opacity = 0;
                            setTimeout(function() { loader.style.display = 'none'; }, 500);
                        }
                    }, 400); // keep loader for at least 400ms for smoothness
                });
            </script>
    {% include 'common/navbar.html' %}
    {% block newbody %} {% endblock newbody %}
    {% block body %}
    {% block messages %}
    {% if messages %}
    <div class="mt-24 mx-auto max-w-4xl px-4">
        {% for message in messages %}
            {% if message.tags == 'error' or message.tags == 'danger' %}
                <div class="glass rounded-lg p-4 mb-4 border-l-4 border-red-500 text-red-100" role="alert">
                    <div class="flex items-center justify-between">
                        <span>{{ message }}</span>
                        <button type="button" class="text-red-100 hover:text-red-200" onclick="this.parentElement.parentElement.style.display='none';">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            {% elif message.tags == 'success' %}
                <div class="glass rounded-lg p-4 mb-4 border-l-4 border-green-500 text-green-100" role="alert">
                    <div class="flex items-center justify-between">
                        <span>{{ message }}</span>
                        <button type="button" class="text-green-100 hover:text-green-200" onclick="this.parentElement.parentElement.style.display='none';">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            {% else %}
                <div class="glass rounded-lg p-4 mb-4 border-l-4 border-blue-500 text-blue-100" role="alert">
                    <div class="flex items-center justify-between">
                        <span>{{ message }}</span>
                        <button type="button" class="text-blue-100 hover:text-blue-200" onclick="this.parentElement.parentElement.style.display='none';">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    </div>
    {% endif %}
    {% endblock messages %}
    {% endblock body %}
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/tripvault/serviceworker.js')
                    .then((registration) => {
                        console.log('ServiceWorker registered: ', registration);
                    })
                    .catch((error) => {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        }
    </script>
    
    {% block script %} {% endblock script %}
</body>
</body>

<!-- Mobile Bottom Navigation Bar -->

<nav id="mobile-bottom-nav" class="fixed bottom-0 left-0 w-full z-50 md:hidden bg-gradient-to-t from-[#1e293b] to-[#0f172a] shadow-2xl py-2 px-2 flex justify-center items-center" style="border-top-left-radius: 1.5rem; border-top-right-radius: 1.5rem;">
    <div class="relative w-full max-w-md mx-auto flex items-center justify-between">
        <div class="flex w-full justify-between items-center">
            <a href="{% url 'friends' %}" class="flex flex-col items-center text-gray-300 hover:text-cyan-400 transition-all pb-6" style="flex:1;">
                <i class="fas fa-user-friends text-xl"></i>
                <span class="text-xs mt-1">Friends</span>
            </a>
            <a href="{% url 'group' %}" class="flex flex-col items-center text-gray-300 hover:text-cyan-400 transition-all pb-6" style="flex:1;">
                <i class="fas fa-users text-xl"></i>
                <span class="text-xs mt-1">Groups</span>
            </a>
            <div class="w-14"></div> <!-- Spacer for plus button -->
            <a href="{% url 'notifications' %}" class="flex flex-col items-center text-gray-300 hover:text-cyan-400 transition-all pb-6" style="flex:1;">
                <i class="fas fa-clock text-xl"></i>
                <span class="text-xs mt-1">Activities</span>
            </a>
            <button id="settings-btn" class="flex flex-col items-center text-gray-300 hover:text-cyan-400 transition-all focus:outline-none pb-6" style="flex:1;">
                <i class="fas fa-cog text-xl"></i>
                <span class="text-xs mt-1">Settings</span>
            </button>
        </div>
        <!-- Plus (center) -->
        <button class="absolute left-1/2 -translate-x-1/2 -top-6 bg-gradient-to-tr from-cyan-400 to-blue-500 rounded-full w-14 h-14 flex items-center justify-center shadow-lg border-4 border-[#1e293b] focus:outline-none z-10">
            <i class="fas fa-plus text-white text-2xl" style="margin-left: -8px;"></i>
        </button>
    </div>
</nav>

<style>
    #mobile-bottom-nav .flex > a, #mobile-bottom-nav .flex > button {
        min-width: 0;
        flex: 1 1 0%;
        text-align: center;
    }
    @media (max-width: 400px) {
        #mobile-bottom-nav .flex > a span, #mobile-bottom-nav .flex > button span {
            font-size: 0.7rem;
        }
    }
    @media (min-width: 350px) {
        #mobile-bottom-nav .flex > a, #mobile-bottom-nav .flex > button {
            padding-left: 0.5rem;
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            html {
                scroll-behavior: smooth;
            }
            body {
                background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
                min-height: 100vh;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            }
            .glass {
                background: rgba(30, 41, 59, 0.5);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.1);
            }
            .glass-dark {
                background: rgba(15, 23, 42, 0.6);
                backdrop-filter: blur(20px);
                border: 1px solid rgba(255, 255, 255, 0.05);
            }
            .gradient-text {
                background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }
            .btn-gradient {
                background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
                transition: all 0.3s ease;
            }
            .btn-gradient:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 20px rgba(6, 182, 212, 0.3);
            }
            a, button {
                transition: all 0.3s ease;
            }
            * {
                border-color: initial !important;
                outline-color: initial !important;
            }
            *[style*="border: 1px solid yellow"], *[style*="outline: 1px solid yellow"] {
                border: none !important;
                outline: none !important;
            }
            * {
                box-shadow: none !important;
            }
            /* MOBILE OPTIMIZATION */
            @media (max-width: 767px) {
                .btn-gradient, .glass, .glass-dark, .trip-card, .planner-card, .metric-card, .field-input, .field-textarea, .people-range {
                    font-size: 0.92rem !important;
                    padding: 6px 8px !important;
                    border-radius: 0.7rem !important;
                }
                button, .btn, .trip-card button, .planner-card button {
                    font-size: 0.92rem !important;
                    padding: 6px 8px !important;
                    min-width: 0 !important;
                }
                .trip-card h3, .planner-card h3, .metric-value, .metric-label {
                    font-size: 1rem !important;
                    margin-bottom: 4px !important;
                }
                .trip-card .trip-meta, .planner-card .trip-meta {
                    font-size: 0.85rem !important;
                    margin-bottom: 2px !important;
                }
                .avatar, .user-avatar, .profile-avatar {
                    width: 32px !important;
                    height: 32px !important;
                    min-width: 32px !important;
                    min-height: 32px !important;
                }
                .user-name, .user-handle, .user-groups, .user-balance {
                    font-size: 0.95rem !important;
                }
                .user-balance {
                    font-weight: 600 !important;
                }
                .trip-actions, .planner-actions {
                    gap: 6px !important;
                }
                .trip-card, .planner-card {
                    padding: 8px !important;
                    margin-bottom: 6px !important;
                }
                .trip-card button, .planner-card button {
                    font-size: 0.92rem !important;
                    padding: 6px 8px !important;
                }
                .metric-value {
                    font-size: 1.1rem !important;
                }
                .metric-label {
                    font-size: 0.85rem !important;
                }
            }
                #settings-sidebar nav {
                    margin-top: 1.5rem;
                }
            </style>
        </div>
    </div>

<script>
// Sidebar open/close logic
document.addEventListener('DOMContentLoaded', function() {
    var sidebar = document.getElementById('settings-sidebar');
    var overlay = document.getElementById('settings-sidebar-overlay');
    var openBtn = document.getElementById('settings-btn');
    var closeBtn = document.getElementById('close-settings');

    function openSidebar() {
        sidebar.style.transform = 'translateX(0)';
        overlay.classList.remove('hidden');
    }
    function closeSidebar() {
        sidebar.style.transform = 'translateX(100%)';
        overlay.classList.add('hidden');
    }

    openBtn?.addEventListener('click', openSidebar);
    closeBtn?.addEventListener('click', closeSidebar);
    overlay?.addEventListener('click', closeSidebar);
});
</script>

<style>
    #mobile-bottom-nav {
        box-shadow: 0 -8px 32px 0 rgba(6,182,212,0.10), 0 1.5px 0 0 rgba(59,130,246,0.10);
    }
    #settings-sidebar {
        box-shadow: -8px 0 32px 0 rgba(6,182,212,0.10), -1.5px 0 0 0 rgba(59,130,246,0.10);
    }
    @media (min-width: 768px) {
        #mobile-bottom-nav, #settings-sidebar { display: none !important; }
    }
</style>
</html>
